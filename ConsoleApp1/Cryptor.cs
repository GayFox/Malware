using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.CodeDom.Compiler;
using System.Runtime.InteropServices;
using System.Drawing;
using IWshRuntimeLibrary;

namespace ConsoleApp1
{
    class Cryptor
    {

        public static string Extract(string ico , string shortcutLocation)
        {
            
            String path = Environment.GetFolderPath(Environment.SpecialFolder.System);
            Console.WriteLine(path);
         // string shortcutLocation = @"C:\Users\Gordan\Zune.lnk";
            string newIconLocation = path+@"\shell32.dll,"+ico;

            IWshShell_Class Shell = new IWshShell_Class();
         //   IWshRuntimeLibrary.IWshShell_Class
            WshShortcut cl = (WshShortcut)Shell.CreateShortcut(shortcutLocation);
            cl.IconLocation = newIconLocation;
            cl.Save();
            return "";
        }
    }
}


    




